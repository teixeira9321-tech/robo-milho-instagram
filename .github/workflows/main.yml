name: "ğŸš€ Motor de Elite - Milho Premium"

on:
  schedule:
    # Agendamento preciso de 2 em 2 horas
    - cron: '0 */2 * * *'
  workflow_dispatch:
    inputs:
      debug_mode:
        description: 'Ativar modo de anÃ¡lise detalhada?'
        required: false
        default: 'false'

jobs:
  execucao-alta-performance:
    name: "Processamento de MÃ­dia e IA"
    runs-on: ubuntu-latest
    timeout-minutes: 15 # Evita que o robÃ´ fique travado gastando seus minutos

    steps:
      - name: "ğŸ“‚ Sincronizando RepositÃ³rio"
        uses: actions/checkout@v4 # VersÃ£o mais recente e veloz

      - name: "ğŸ Setup Python Otimizado"
        uses: actions/setup-python@v5
        with:
          python-version: '3.11' # VersÃ£o mais rÃ¡pida que a 3.10
          cache: 'pip' # Ativa o cache automÃ¡tico do GitHub

      - name: "ğŸ“¦ InjeÃ§Ã£o de DependÃªncias de Alta Performance"
        run: |
          python -m pip install --upgrade pip
          pip install instagrapi requests google-genai pillow
          # Pillow adicionado para prÃ©-processamento de imagens se necessÃ¡rio

      - name: "âš™ï¸ AtivaÃ§Ã£o do Motor Inteligente"
        env:
          # Segredos Blindados
          INSTA_SESSION: ${{ secrets.INSTA_SESSION }}
          GEMINI_KEY: ${{ secrets.GEMINI_KEY }}
          PYTHONUNBUFFERED: 1 # ForÃ§a o log a aparecer em tempo real
        run: |
          echo "ğŸš€ Iniciando ciclo de postagem automatizada..."
          python main.py
          echo "âœ… Ciclo finalizado com sucesso."

      - name: "ğŸ“Š RelatÃ³rio de ExecuÃ§Ã£o"
        if: always()
        run: |
          echo "Finalizado em: $(date)"
